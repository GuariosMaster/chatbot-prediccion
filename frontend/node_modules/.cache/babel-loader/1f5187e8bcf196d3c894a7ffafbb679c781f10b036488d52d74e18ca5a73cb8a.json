{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Guariox\\\\Desktop\\\\chatbot\\\\frontend\\\\src\\\\components\\\\ChatsPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { chatService } from '../services/api';\nimport MessageList from './MessageList';\nimport MessageInput from './MessageInput';\nimport '../styles/chatbot.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatsPage = () => {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [conversations, setConversations] = useState([]);\n  const [currentConversationId, setCurrentConversationId] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const {\n    user,\n    logout\n  } = useAuth();\n  useEffect(() => {\n    loadConversations();\n  }, []);\n  const loadConversations = async () => {\n    try {\n      const response = await chatService.getHistory();\n      setConversations(response.conversations || []);\n    } catch (error) {\n      console.error('Error al cargar conversaciones:', error);\n    }\n  };\n  const loadMessages = async conversationId => {\n    try {\n      setLoading(true);\n      const response = await chatService.getHistory(conversationId);\n      setMessages(response.messages || []);\n      setCurrentConversationId(conversationId);\n    } catch (error) {\n      console.error('Error al cargar mensajes:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleSendMessage = async messageText => {\n    try {\n      const response = await chatService.sendMessage(messageText, currentConversationId);\n\n      // Agregar mensajes a la lista\n      const newMessages = [response.userMessage, response.botMessage];\n      setMessages(prev => [...prev, ...newMessages]);\n\n      // Actualizar ID de conversación si es nueva\n      if (!currentConversationId) {\n        setCurrentConversationId(response.conversationId);\n        loadConversations(); // Recargar lista de conversaciones\n      }\n    } catch (error) {\n      console.error('Error al enviar mensaje:', error);\n    }\n  };\n  const startNewConversation = () => {\n    setMessages([]);\n    setCurrentConversationId(null);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-sidebar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Conversaciones\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startNewConversation,\n          className: \"new-chat-btn\",\n          children: \"+ Nueva\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"conversations-list\",\n        children: conversations.map(conv => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `conversation-item ${currentConversationId === conv.id ? 'active' : ''}`,\n          onClick: () => loadMessages(conv.id),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"conversation-title\",\n            children: conv.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"conversation-date\",\n            children: new Date(conv.last_message_at).toLocaleDateString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 15\n          }, this)]\n        }, conv.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"Hola, \", user === null || user === void 0 ? void 0 : user.username]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: logout,\n          className: \"logout-btn\",\n          children: \"Salir\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-main\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"chat-title\",\n          children: \"Chatbot de Predicci\\xF3n de Fallos\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-actions\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => window.location.href = '/predictions',\n            className: \"prediction-btn\",\n            children: \"Predicciones\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading\",\n        children: \"Cargando mensajes...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(MessageList, {\n        messages: messages\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(MessageInput, {\n        onSendMessage: handleSendMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatsPage, \"tw403IIouwgopzHoBbJ8cb1txEo=\", false, function () {\n  return [useAuth];\n});\n_c = ChatsPage;\nexport default ChatsPage;\nvar _c;\n$RefreshReg$(_c, \"ChatsPage\");","map":{"version":3,"names":["React","useState","useEffect","useAuth","chatService","MessageList","MessageInput","jsxDEV","_jsxDEV","ChatsPage","_s","messages","setMessages","conversations","setConversations","currentConversationId","setCurrentConversationId","loading","setLoading","user","logout","loadConversations","response","getHistory","error","console","loadMessages","conversationId","handleSendMessage","messageText","sendMessage","newMessages","userMessage","botMessage","prev","startNewConversation","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","map","conv","id","title","Date","last_message_at","toLocaleDateString","username","window","location","href","onSendMessage","_c","$RefreshReg$"],"sources":["C:/Users/Guariox/Desktop/chatbot/frontend/src/components/ChatsPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { chatService } from '../services/api';\nimport MessageList from './MessageList';\nimport MessageInput from './MessageInput';\nimport '../styles/chatbot.css';\n\nconst ChatsPage = () => {\n  const [messages, setMessages] = useState([]);\n  const [conversations, setConversations] = useState([]);\n  const [currentConversationId, setCurrentConversationId] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const { user, logout } = useAuth();\n\n  useEffect(() => {\n    loadConversations();\n  }, []);\n\n  const loadConversations = async () => {\n    try {\n      const response = await chatService.getHistory();\n      setConversations(response.conversations || []);\n    } catch (error) {\n      console.error('Error al cargar conversaciones:', error);\n    }\n  };\n\n  const loadMessages = async (conversationId) => {\n    try {\n      setLoading(true);\n      const response = await chatService.getHistory(conversationId);\n      setMessages(response.messages || []);\n      setCurrentConversationId(conversationId);\n    } catch (error) {\n      console.error('Error al cargar mensajes:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSendMessage = async (messageText) => {\n    try {\n      const response = await chatService.sendMessage(messageText, currentConversationId);\n      \n      // Agregar mensajes a la lista\n      const newMessages = [response.userMessage, response.botMessage];\n      setMessages(prev => [...prev, ...newMessages]);\n      \n      // Actualizar ID de conversación si es nueva\n      if (!currentConversationId) {\n        setCurrentConversationId(response.conversationId);\n        loadConversations(); // Recargar lista de conversaciones\n      }\n    } catch (error) {\n      console.error('Error al enviar mensaje:', error);\n    }\n  };\n\n  const startNewConversation = () => {\n    setMessages([]);\n    setCurrentConversationId(null);\n  };\n\n  return (\n    <div className=\"chat-container\">\n      {/* Sidebar con conversaciones */}\n      <div className=\"chat-sidebar\">\n        <div className=\"chat-header\">\n          <h3>Conversaciones</h3>\n          <button onClick={startNewConversation} className=\"new-chat-btn\">\n            + Nueva\n          </button>\n        </div>\n        \n        <div className=\"conversations-list\">\n          {conversations.map(conv => (\n            <div \n              key={conv.id}\n              className={`conversation-item ${currentConversationId === conv.id ? 'active' : ''}`}\n              onClick={() => loadMessages(conv.id)}\n            >\n              <div className=\"conversation-title\">{conv.title}</div>\n              <div className=\"conversation-date\">\n                {new Date(conv.last_message_at).toLocaleDateString()}\n              </div>\n            </div>\n          ))}\n        </div>\n        \n        <div className=\"user-info\">\n          <span>Hola, {user?.username}</span>\n          <button onClick={logout} className=\"logout-btn\">Salir</button>\n        </div>\n      </div>\n      \n      {/* Área principal de chat */}\n      <div className=\"chat-main\">\n        <div className=\"chat-header\">\n          <h2 className=\"chat-title\">Chatbot de Predicción de Fallos</h2>\n          <div className=\"chat-actions\">\n            <button \n              onClick={() => window.location.href = '/predictions'}\n              className=\"prediction-btn\"\n            >\n              Predicciones\n            </button>\n          </div>\n        </div>\n        \n        {loading ? (\n          <div className=\"loading\">Cargando mensajes...</div>\n        ) : (\n          <MessageList messages={messages} />\n        )}\n        \n        <MessageInput onSendMessage={handleSendMessage} />\n      </div>\n    </div>\n  );\n};\n\nexport default ChatsPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}